\documentclass[12pt,a4paper,oneside]{article} %стиль оформления - статья с параметрами: шрифт 12, формат бумаги А4, печать с одинаковыпи полями на всех страницах - oneside
\usepackage[T2A]{fontenc} %поддержка кириллицы
\usepackage[utf8]{inputenc} %кодировка символов
\usepackage[english,russian]{babel} %пакет поддержки русского языка с элементами английского
\frenchspacing
\usepackage[dvips]{graphicx} %разрешить включение PostScript-графики
\graphicspath{{images/}}
\usepackage{setspace} %"умное" расстояние между строк
\usepackage[usenames,dvipsnames]{color}
\usepackage{hhline} %работа с таблицами
\usepackage[12pt]{extsizes} %размер шрифта
\usepackage{fancyhdr} %установка колонтитулов

\usepackage{geometry} %ручная установка полей
\geometry{top=1cm} %поле сверху
\geometry{bottom=1cm} %поле снизу
\geometry{left=2cm} %поле слева
\geometry{right=2cm} %поле справа

\begin{document}
\singlespacing % межстрочный одиночный интервал для всего текста
\pagestyle{empty} % нумерация выкл.

%Н:задание на уир и кп
\newpage
\begin{center}
МИНИСТЕРСТВО ОБРАЗОВАНИЯ И НАУКИ РОССИЙСКОЙ ФЕДЕРАЦИИ

Федеральное государственное бюджетное образовательное учреждение \linebreak
высшего профессионального образования

\textbf{"Национальный исследовательский ядерный университет "МИФИ"}
\\[10pt]

\begin{figure}[h]
\includegraphics[width=0.25\linewidth]{mifi}
\end{figure}

ФАКУЛЬТЕТ КИБЕРНЕТИКИ
\\[15pt]

КАФЕДРА ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ
\\[60pt]

\LARGE{\textbf{ПОЯСНИТЕЛЬНАЯ ЗАПИСКА}}
\\[10pt]

\large{к курсовому проекту на тему:}
\\[10pt]

\large{\underline{Разработка модуля преобразования геоданных из формата\hspace{4cm}} \linebreak
\underline{OpenStreetMap в формат OpenGIS\hspace{9,4cm}}}
\\[50pt]
\end{center}

\begin{flushleft}
\large{Группа \underline{К7-361\hspace{13cm}}

Студент \underline{\hspace{9,5cm} (Лаврентьева М.О.)}

Руководитель \underline{\hspace{9cm} (Муравьёв С.К.)}

Оценка \underline{\hspace{14,25cm}}

Члены комиссии \underline{\hspace{12,2cm}}

\hspace{3,7cm} \underline{\hspace{12,2cm}}

\hspace{3,7cm} \underline{\hspace{12,2cm}}

\hspace{3,7cm} \underline{\hspace{12,2cm}}}

\end{flushleft}
\begin{center}
\vfill
\large{\textbf{Москва 2011}}
\end{center}
%K: титульный лист
%Н: литература
\newpage
\subsubsection*{Литература}
%К: литература
%Н: оглавление
\newpage
\tableofcontents

%К: оглавление
%Н: введение
\newpage
\section{Введение}

\large{

В настоящее время широкое распространение в информационных \linebreak %борьба с переносами
технологиях получили геоинформационные системы (ГИС). ГИС  \linebreak %борьба с переносами
представляет собой аппаратно-программный человеко-машинный \linebreak %борьба с переносами
комплекс, обеспечивающий сбор, обработку, отображение и \linebreak
распространение геоданных.

Понятие геоданные (пространственные данные, географические \linebreak
данные) включает в себя цифровые данные о пространственных \linebreak
объектах, сведения об их местоположении и свойствах, пространственных \linebreak
и непространственных атрибутах.

ГИС позволяет наиболее эффективно и комплексно  использовать \linebreak
совершенно различные геоданные при решении научных и прикладных \linebreak
географических задач, связанных с инвентаризацией, анализом, \linebreak
моделированием, прогнозированием и управлением окружающей средой и \linebreak
территориальной организацией общества. Термин ГИС используется \linebreak
в более узком смысле — как инструмент (программный продукт), \linebreak
позволяющий пользователям искать, анализировать и редактировать \linebreak
цифровые карты, а также получать различную дополнительную \linebreak
информацию. Наиболее известные и часто используемые современные \linebreak
ГИС - это ArcGIS, MapInfo, а также Google Maps, Yandex-карты.

Данная учебно-исследовательская работа посвящена рассмотрению \linebreak
задачи сбора, обмена и хранения геоданных.

Картографические данные будут получены из открытого источника \linebreak
в интернете OpenStreetMap.org в формате xml.

Однако обмен и хранение пространственных данных требует \linebreak
развитой и всеобъемлющей системы стандартов представления \linebreak
геоданных. Такой системой стандартов для многих приложений \linebreak
на данный момент является формат Open Geospatial \linebreak
Consortium (OGC) (или сокращенно OpenGIS). Таким образом,  \linebreak
для дальнейшего анализа и представления полученных \linebreak
геоданных их необходимо представить в данном формате \linebreak
(в формате OpenGIS).

Итак, \underline{цель работы}: описание алгоритма работы \linebreak
и реализация функционала модуля преобразования геоданных \linebreak
из формата OpenStreetMap в формат OpenGIS.}

%К: введение
%Н: описание алгоритма
\newpage
\section{Описание алгоритма работы модуля}
\subsection{Описание логики алгоритма}
Алгоритм состоит из следующих этапов:
\begin{enumerate}
\item Ввод имени XML-файла для извлечения необходимой информации.
\item Формирование XPath-запроса для извлечения геоданных об объектах необходимого типа.
\item Формирование результата XPath-запроса, вывод извлеченных геоданных.
\item Формирование SQL-запроса к базе данных для сохранения извлеченных геоданных в формате OpenGIS.
\item Формирование отчёта о занесении геоданных в базу данных.
\end{enumerate}

\textbf{Ввод имени XML-файла для извлечения необходимой информации.}

Выбор XML-файла осуществляется пользователем из заранее заданного набора файлов.

\textbf{Формирование XPath-запроса для извлечения геоданных об объектах необходимого типа.}

Формирование Xpath-запроса происходит непосредственно пользователем в соответствующем окне программы.

\textbf{Формирование результата XPath-запроса, вывод извлеченных геоданных.}

Результаты XPath-запроса выводятся на экран в соответствующем окне программы.

\textbf{Формирование SQL-запроса к базе данных для сохранения извлеченных геоданных.}

SQL-запрос формируется программистом до запуска модуля. Формируется без участия пользователя.

\textbf{Формирование отчёта о занесении геоданных в базу данных.}

Отчёт о занесении геоданных в БД выводится на экран в соответствующем окне программы.

\newpage
\subsection{Блок-схема алгоритма}

\includegraphics[width=0.9\linewidth]{box}

%К: описание алгоритма
%Н: теоретическая часть
\newpage
\section{Теоретическая часть}

\subsection{Язык XML}

\subsubsection{Общие сведения}

Язык разметки (в компьютерной терминологии) - набор символов или последовательностей, вставляемых в текст для передачи информации о его выводе или строении. Принадлежит классу компьютерных языков, но не является языком программирования. Текстовый документ, написанный с использованием языка разметки, содержит не только сам текст (как последовательность слов и знаков препинания), но и дополнительную информацию о различных его участках (например, указание на заголовки, выделения, списки и т.д.). Иногда язык разметки позволяет вставлять в документ интерактивные элементы и содержание других документов. Языки разметки используются везде, где требуется вывод форматированного текста - в типографии (SGML,  TeX, PostScript, PDF), пользовательских интерфейсах компьютеров (MicrosoftWord, OpenOffice), Всемирной Сети (HTML,  XHTML,  XML,  WML,  VML,  PGML,  SVG,  XBRL).

Общая особенность всех языков разметки состоит в том, что они перемешивают текст документа с инструкциями разметки в потоке данных или файле. Это не необходимость, разметку можно изолировать от текста, используя указатели, метки, идентификаторы или другие методы координации. Такая "отделенная разметка" характерна для внутреннего представления программ, работающих с размеченными документами.

Родоначальником наиболее известных в наше время языков разметки является обобщенный структурированный язык разметки (Structured Generalized Language) - SGML, определенный в международном стандарте ISO 8879:1986. Языки HTML(HyperText Markup Language - язык разметки гипертекста) и XML (eXtensible Markup Language - расширяемый язык разметки) различными способами образованы из SGML.

SGML определяет базовый синтаксис, но дает возможность создавать собственные элементы (отсюда термин "обобщенный" в названии языка). Чтобы использовать SGML для описания определенного документа, необходимо продумать соответствующий набор элементов и структуру документа.

Основные части документа SGML:

\begin{itemize}
\item SGML-декларация. Определяет, какие символы и ограничители могут появляться в приложении;
\item Document Type Definition. Определяет синтаксис конструкций разметки. DTD может включать дополнительные определения, такие, как символьные ссылки-мнемоники.

\item Спецификация семантики, относится к разметке. Даёт ограничения синтаксиса, которые не могут быть выражены внутри DTD;

\item Содержимое SGML. В содержимом SGML-документа по крайней мере должен быть корневой элемент.
\end{itemize}

В 1996 г. группа XML Working Group консорциума World Wide Web Consortium (W3C) разработала ветвь языка SGML, специально приспособленную для размещения информации в World Wide Web (аналогично стандартному для Web языку гипертекстовой разметки HTML (Hypertext Markup Language)). "XML предназначен для облегчения использования языка SGML в Web и выполнения задач, которые в настоящее время реализуются с помощью языка HTML. XML разработан с целью усовершенствовать применение и взаимодействие языков SGML и HTML."(спецификация версии 1.0 XML)

Как и SGML, XML дает возможность разрабатывать собственные наборы элементов при описании определенного документа и присваивать им любые имена по выбору (поэтому XML - расширяемый язык). Как и в SGML, в теле программы может быть определено XML-приложение (или словарь), которое содержит набор наиболее употребительных элементов общего назначения и структуру документа, которая может быть использована для описания документа определенного типа.

Таким образом,  XML является подмножеством SGML, разработанным для упрощения процесса машинного разбора документа.

Кроме того, XML - это текстовый формат, предназначенный для хранения структурированных данных (взамен существующих файлов баз данных), для обмена информацией между программами, а также для создания на его основе более специализированных языков разметки (например, XHTML), иногда называемых словарями, то есть XML можно использовать для описания практически любого документа, от музыкальной партитуры до баз данных.

Взаимосвязь между SGML, XML, HTML и некоторыми другими языками показана на следующей диаграмме:

\includegraphics[width=0.85\linewidth]{07-01}

\newpage
\subsubsection{Структура XML-документа}	

Основные синтаксические правила построения XML документов:

\begin{enumerate}
\item XML документ содержит один и только один корневой элемент, содержащий все остальные элементы.

\item Дочерние элементы, содержащиеся в корневом элементе, должны быть правильно вложены.

\item Имена элементов подчиняются правилам:
\begin{itemize}
\item Имя начинается с буквы, знака подчеркивания или двоеточия.
\item	После первого символа в имени могут быть буквы, цифры, знаки переноса, подчеркивания, точка или двоеточие.
\item	Имена не могут начинаться с буквосочетания XML.
\end{itemize}
\end{enumerate}

XML документ имеет следующую структуру:

\begin{itemize}
\item Первая строка XML документа называется объявлением XML. Это необязательная строка, указывающая версию стандарта XML (обычно это 1.0). Также здесь может быть указана кодировка символов и внешние зависимости.
\item	Комментарий может быть размещен в любом месте дерева. XML комментарии размещаются внутри пары тегов <!-- и заканчиваются -->. Два знака дефис (--) не могут быть применены ни в какой части внутри комментария.
\item	Остальная часть этого XML -документа состоит из вложенных элементов, некоторые из которых имеют атрибуты и содержимое.
\item	Элемент обычно состоит из открывающего и закрывающего тегов, обрамляющих текст и другие элементы.
\item	Открывающий тег состоит из имени элемента в угловых скобках; закрывающий тег состоит из того же имени в угловых скобках, но перед именем ещё добавляется косая черта.
\item Содержимым элемента называется всё, что расположено между открывающим и закрывающим тегами, включая текст и другие (вложенные) элементы.
\item	Кроме содержания у элемента могут быть атрибуты - пары имя=значение, добавляемые внутрь открывающего тега после названия элемента.
\item	Значения атрибутов всегда заключаются в кавычки (одинарные или двойные), одно и то же имя атрибута не может встречаться дважды в одном элементе.
\item	Не рекомендуется использовать разные типы кавычек для значений атрибутов одного тега.
\item	Для обозначения элемента без содержания, называемого пустым элементом, необходимо применять особую форму записи, состоящую из одного тега, в котором после имени элемента ставится косая черта "/".
\end{itemize}

Описанные выше правила позволяют контролировать только формальную правильность XML документа, но не содержательную. Для решения второй задачи используются так называемые схемы.

Схема четко определяет имя и структуру корневого элемента, включая спецификацию всех его дочерних элементов. Программист может задать, какие элементы и в каком количестве обязательны, а какие - необязательны. Схема также определяет, какие элементы содержат атрибуты, допустимые значения этих атрибутов, а также значения по умолчанию.

Чаще всего для описания схемы используются следующие спецификации:
\begin{itemize}
\item	DTD (Document Type Definition) - язык определения типа документов, который первоначально использовался в качестве язык описания структуры SGML -документа.
\item	XDR (XML Data Reduced) - диалект XML, разработанный Microsoft.
\item	XSD (язык определения схем XML) - рекомендация консорциумом W3C с 2001 года.
\end{itemize}

\newpage
\subsection{OpenStreetMap}
\subsubsection{Описание OpenStreetMap.org}

OpenStreetMap ("открытая карта улиц"), сокращённо OSM, - некоммерческий сетевой картографический проект, в котором могут участвовать все желающие пользователи Интернета. Он направлен на создание подробной свободной и бесплатной географической карты всего мира. Все данные доступны для легального копирования, редактирования и коммерческого использования. База данных OSM содержит данные самого разного рода, например, дороги, тропы, здания, магазины, аптеки, памятники, деревья, заборы, детские площадки, точки Wi-Fi, почтовые ящики, телефонные будки, административное деление, адреса, этажность зданий, часы работы, веб-сайты, телефоны и многое другое.

OpenStreetMap остаётся единственным картографическим проектом, который является свободным проектом. Основными конкурентами являются сайты Google Map Maker, Wikimapia, Яндекс.Народная карта, но все эти проекты имеют общий недостаток - они являются "закрытыми" и несвободными.

Данные об основных дорогах обычно получаются из истории "треков". Они записаны GPS-приёмниками или GPS-трекерами. Такие треки создаются добровольцами и выполняются в результате путешествий по исследуемому району пешком, на велосипеде или на автомобиле. Затем треки экспортируются из GPS-устройства в специальную программу.

Спутниковые снимки земной поверхности позволяют рисовать, не имея треков, карты крупных городов (для которых имеются снимки высокого разрешения). В качестве источников используются правительственные сервисы, такие как Landsat, Prototype Global Shorelines (PGS) и TIGER, а также картографические сервисы Yahoo!, Bing Maps и Космоснимки.

\newpage
\subsubsection{Особенности XML-документа OpenStreetMap}

OpenStreetMap использует топологическую структуру данных, состоящую из объектов:

- node (точка) - точка с указанными координатами;

- way (линия) - упорядоченный список точек, составляющих линию или полигон (замкнутая линия);

- relation (отношение) - группы точек, линий и других отношений, которым назначаются некоторые свойства;

- tag (тег) - пары "ключ - значение", могут назначаться точкам, линиям и отношениям.

Информацию с OSM можно получить и в интересующем нас формате XML. Рассмотрим структуру XML-документа на примере документа OpenSreetMap (OSM).

\includegraphics[width=1\linewidth]{type}

XML-документ OSM состоит из двух основных частей: пролога и тела документа.

Пролог предваряет любой документ, может содержать идентификационную информацию о XML-документе (спецификация требует ее включения), а может быть абсолютно пустым.

В OSM в пролог входит объявление XML, указывающее на то, что это XML-документ и содержащее номер версии (version) и используемую кодировку (encoding declaration).

<?xml version="1.0" encoding="UTF-8">

Пролог также может содержать комментарии и другие инструкции по обработке, которые сообщают XML-процессору, как обрабатывать конструкции, находящиеся между <? и ?>.

Второй основной частью XML-документа является тело документа (Документ, корневой элемент), который в свою очередь содержит дополнительные элементы. В XML-документе элементы определяют его логическую структуру и несут в себе информацию, содержащуюся в документе (в нашем случае это информация о геообъектах, такая как тип геообъекта, его название, координаты и т.д.). Типовой элемент состоит из начального тега, содержимого элемента и конечного тега. Содержимым элемента могут быть символьные данные, другие (вложенные) элементы, либо сочетание данных и вложенных элементов.

В нашем случае элемент Документ – osm. Его начальный тег – <osm>, конечный тег – </osm>, а содержимое – вложенные элементы bounds (границы рассматриваемой области с атрибутами minlat, maxlat, minlon, maxlon), node, way, relation. Корневой элемент также имеет атрибуты - versoin (версия Application Programming Interface, для возможности использования во внешних программных продуктах) и generator (программа, с помощью которой был создан этот файл).

В OpenStreetMap нет ограничений на теги, которыми могут быть помечены элементы OSM. Но все же существует рекомендованный набор объектов и соответсвующих им тегов для структурированной работы.

\begin{enumerate}
\item Базовые типы элементов: точка (node), линия(way) и полигон(area).
\begin{itemize}
\item точка (node) - базовый элемент в структуре данных OSM. Точка имеет параметры "широта" и "долгота". Точки используются для того, чтобы определить "линию" (см. ниже), однако точка может являться и самостоятельным элементом карты, и использоваться для обозначения отдельного ни с чем не связанного объекта (например, телефонной будки, кафе, для указания координат, к которым привязано название населённого пункта или любого интересного места (POI — point of interest). Отдельные точки (т.е. не входящие в состав линий или областей) всегда должны иметь хотя бы одно свойство, например amenity=parking (объект инфраструктуры - парковка).

    Точки, входящие в состав линии, часто не имеют свойств и нужны только для описания линии; однако это не является незыблемым правилом. Например, точка, входящая в состав линии со свойством railway=rail (т. е. линии, обозначающей полотно железной дороги) и обозначающий остановочный пункт железной дороги имеет свойство railway=station.


\item линия (way). Линия представляет собой ломаную линию, проходящую через точки. Линия состоит, как минимум, из двух точек. Обычно линиями обозначаются улицы, дороги и т.д. Одна точка может принадлежать нескольким линиям одновременно.

    Линия характеризуется свойствами, которые распространяются на неё на всём протяжении. Например, для линии, обозначающей дорогу, такими свойствами могут являться тип и качество покрытия, допустимая скорость движения и т.п. Если при уточнении выясняется, что не все свойства линии сохраняются на всём её протяжении (например, на дороге, которой соответствует линия, имеется участок с другим типом покрытия), то линия может быть разделена на части.

    Для того, чтобы считаться корректно определённой, линия должна иметь хотя бы одно свойство.

\item полигон (area) или замкнутая линия (closed way) - элемент карты, предназначенный для описания участков поверхности. Полигон формируется замкнутой линией  (т.е. первая точка линии совпадает с последней) и является совокупностью этой самой линии и области, находящейся внутри контура этой линии. В этом смысле полигон не является самостоятельным типом элементов, а лишь псевдо-элементом, особой разновидностью линии с соответствующими свойствами.

    Полигоны используются для обозначения участка поверхности, обладающего общими свойствами. Например, полигоны используются для описания водоёмов и лесов.

    Корректно определённый полигон должен иметь хотя бы одно свойство.

    Для описания вырезов, «дыр» в полигонах, например, для описания участка занятого лесом, внутри которого имеется вырубленный участок рисуются мультиполигоны.
\end{itemize}
\item Тип элементов - отношение (relation). Отношение группирует объекты по определенному признаку и для определенной цели. 'Участниками' (member) отношения могут любые объекты (точки, линии, области) и даже другие отношения. Эти элементы — участники отношения и каждому участнику присваивается 'роль' (role) в отношении. Как и другие типы элементов могут иметь теги. Один объект может входить в несколько отношений.

    Один объект может входить в отношение несколько раз.

    Тег 'тип' (type) устанавливает разновидность отношения. Отношения могут описывать замкнутые дороги, запреты поворотов и т.д.

    Расположение участников в отношении постоянно и определяется очередностью добавления. Повторяющиеся объекты сохраняют их определенный порядок.

\item Теги ('teg'). Тег строго говоря не элемент, а свойство объекта. Каждый тег имеет атрибуты - ключ (k) и значение (v). Ключи и их значения описывают объект и наделяют его свойствами.
\end{enumerate}

Для всех элементов существуют общие атрибуты:

\begin{itemize}
\item user - имя пользователя, который совершал последнее изменение объекта;
\item uid - числовой идентификатор пользователя, который совершил последнее изменение объекта;
\item timestap - время последнего изменения;
\item visible - является ли объект удаленным в базе данных. Если visible="false", то объект должен быть возвращен вызовом истории изменений;
\item version - версия редакции объекта. Версия вновь созданных объектов равна 1, это значение увеличивается на сервере, когда клиент добавляет новую версию объекта. Сервер будет отклонять новую версию объекта, если версия присланная клиентом не соответствует текущей версии объекта в базе данных;
\item chengeset - пакет правок (история) в котором указаны создание и изменения объектов.
\end{itemize}

Особенности элемента 'точка'.

\begin{itemize}
\item атрибут id - числовой идентификационный номер, который уникален только среди точек. (Линия может иметь такое же id как и точка.);
\item атрибут lat - координаты широты;
\item атрибут lon - координаты долготы;
\item теги - множество пар тегов (ключ - значение) с уникальным ключом;
\end{itemize}

Пример.

\includegraphics[width=1.2\linewidth]{node}

Особенности элемента 'линия'.

\begin{itemize}
\item атрибут id - числовой идентификационный номер, не являются уникальными, линия может иметь такой же идентификатор, как точка;
\item nodes - теги (nd) с атибутом ref (идентификатор точки), являющиеся списком всех точек идентификаторы которых составляют линию;
\item теги - множество пар тегов (ключ - значение) с уникальным ключом;
\end{itemize}

Пример.

\includegraphics[width=1\linewidth]{way}

Особенности элемента 'отношение'.
\begin{itemize}
\item атрибут id - числовой идентификационный номер, не являются уникальными, линия может иметь такой же идентификатор, как точка;
\item теги - множество пар тегов (ключ - значение) с уникальным ключом;
\item members - упорядоченный список примитивов с атрибутами роль (где ролью может быть любой текст), тип (тип примитива), ref (идентификатор примитива).
\end{itemize}

Пример.

\includegraphics[width=1.2\linewidth]{ref}

\newpage
\subsection{XPath}
\subsubsection{Общие сведения}
Язык XML Path (XPath) является набором синтаксических и семантических правил для ссылок на части XML-документов. XPath предназначен для использования другими спецификациями, например, такими как XSL Transformations (XSLT) и XML Pointer Language (XPointer).

Главная задача языка XPath - адресация частей в XML документе. Для достижения этой цели язык дополнительно наделен основными функциями для манипулирования строками, числами и булевыми значениями. В XPath используется компактный синтаксис, отличающийся от принятого в XML и облегчающий использование языка XPath. XPath работает не с внешним синтаксисом XML документа, а с его абстрактной логической структурой. XPath получил такое название потому, что использовался в URL для записи путей, обеспечивающих навигацию по иерархической структуре XML документа.
Язык XPath спроектирован так, что помимо поддержки адресации он обладает естественным набором элементов, которые могут использоваться для сравнения (проверки, соответствует ли узел некому шаблону).

XPath представляет XML-документ как дерево узлов. Узлы могут быть разных типов, таких как узлы элементов, узлы атрибутов или узлы текста. Для каждого типа узлов в XPath определяется способ вычисления строкового значения. Некоторые типы узлов имеют также имя. XPath полностью поддерживает пространства имен XML. В результате, имя любого узла в этом языке образуется из двух частей: локальной части и URI (унифицированный (единообразный) идентификатор ресурса - это последовательность символов, идентифицирующая абстрактный или физический ресурс) некого пространства имен (возможно, нулевого). Такая комбинация называется расширенным именем.

Специальным типом узла является корневой узел. XML-документ содержит только один такой узел и он является корнем дерева, содержащего весь XML-документ. Корневой узел содержит корневой элемент, а также любые узлы инструкций обработки, объявлений или комментариев, которые появляются до или после корневого элемента.

Не существует типа узла для XML-декларации (такой, \break как <?xml version="1.0" encoding="UTF-8"?> ). Следовательно, на такие сущности нельзя ссылаться в XPath.

Элементные узлы представляют каждый элемент в XML-документе. Узлы атрибутов принадлежат элементным узлам и представляют атрибуты в XML-документе. Однако, атрибуты, которые начинаются с xmlns: представляются в XPath с узлами пространств имен. Другие типы узлов включают в себя текстовые узлы, узлы инструкций обработки и узлы комментариев.

Главной синтаксической конструкцией языка XPath является выражение.

В результате обработки выражения получается объект, относящийся к одному из четырех основных типов:

- набор узлов (node-set) - неупорядоченный набор узлов без дубликатов;

- булево значение (boolean) - true или false;

- число (number) - число с плавающей точкой;

- строка (string) - последовательность UCS символов.

\subsubsection{Типовые XPath-запросы}

Рассмотрим типовые XPath-запросы на следующем примере:

\includegraphics[width=1\linewidth]{examplemap}

\textbf{Выражения для путей адресации:}

/ - дочерний элемент узла. Результат: '/osm' - элемент osm;

// -  элементы документа, которые соответствуют указанному шаблону. Результат: '//osm' - элемент osm и его подэлементы;

| - список дочерних элементов. Результат: 'osm|node' - список дочерних элементов.

\textbf{Оси - это база языка XPath.}
\begin{itemize}
\item ancestor:: — Возвращает множество предков.
\item ancestor-or-self:: — Возвращает множество предков и текущий элемент.
\item attribute:: — Возвращает множество атрибутов текущего элемента.
\item child:: — Возвращает множество потомков на один уровень ниже.
\item descendant:: — Возвращает полное множество потомков.
\item descendant-or-self:: — Возвращает полное множество потомков и текущий элемент.
\item following:: — Возвращает необработанное множество, ниже текущего элемента.
\item following-sibling:: — Возвращает множество элементов на том же уровне, следующих за текущим.
\item namespace:: — Возвращает множество имеющее пространство имён (то есть присутствует атрибут xmlns).
\item parent:: — Возвращает предка на один уровень назад.
\item preceding:: — Возвращает множество обработанных элементов исключая множество предков.
\item preceding-sibling:: — Возвращает множество элементов на том же уровне, предшествующих текущему.
\item self:: — Возвращает текущий элемент.
\end{itemize}

Существуют сокращения для некоторых осей, например:
\begin{itemize}
\item attribute:: — можно заменить на «@»;
\item child:: — часто просто опускают;
\item descendant:: — можно заменить на '//';
\item parent:: — можно заменить на '..';
\item self:: — можно заменить на '.';
\end{itemize}

Подробное описание функций см. в Приложении А.

(сюда по ходу работы занесу нужные запросы)

\newpage
\subsection{PostgreSQL и OpenGIS}

\newpage
\subsection{SQL}

\newpage
\subsection{Язык C++ и библиотека QT}

%К: теоретическая часть
%Н: практическая часть
\newpage
\section{Практическая часть}
\subsection{Фрагменты кода}



%К: практическая часть
%Н: приложение
\newpage
\section{Приложение}
\subsection{Приложение А. Список функций XPath}

\textbf{Системные функции.}

\begin{itemize}
\item node-set document(object, node-set?) - возвращает документ, указанный в параметре object.
\item string format-number(number, string, string?) - форматирует число согласно образцу, указанному во втором параметре, третий параметр указывает именованный формат числа, который должен быть учтён.
\item string generate-id(node-set?) - возвращает строку, являющуюся уникальным идентификатором.
\item node-set key(string, object) - возвращает множество с указанным ключом (аналогично функции id для идентификаторов).
\item string unparsed-entity-uri(string) - возвращает непроанализированный URI, если такового нет, возвращает пустую строку.
\item boolean element-available(string) - проверяет, доступен ли элемент или множество, указанное в параметре. Параметр рассматривается как XPath.
\item boolean function-available(string) - проверяет, доступна ли функция, указанная в параметре. Параметр рассматривается как XPath.
\item object system-property(string) - параметры, возвращающие системные переменные, могут быть:
- xsl:version — возвращает версию XSLT процессора.

- xsl:vendor — возвращает производителя XSLT процессора.

- xsl:vendor-url — возвращает URL, идентифицирующий производителя.

Если используется неизвестный параметр, функция возвращает пустую строку.

\item boolean lang(string) - возвращает истину, если у текущего тега имеется атрибут xml:lang, либо родитель тега имеет атрибут xml:lang и в нем указан совпадающий строке символ.
\end{itemize}

\textbf{Функции с множествами.}

* — обозначает любое имя или набор символов, @* — любой атрибут.

\$name - обращение к переменной, где name — имя переменной или параметра.

[] — дополнительные условия выборки.

\{\} — если применяется внутри тега другого языка (например HTML), то XSLT процессор рассматривает содержимое фигурных скобок как XPath.

/ — определяет уровень дерева.
\begin{itemize}
\item node-set node() - возвращает все узлы. Для этой функции часто используют заменитель '*', но в отличие от звездочки — node() возвращает и текстовые узлы.
\item string text() - возвращает набор текстовых узлов
\item node-set current() - возвращает множество из одного элемента, который является текущим. Если мы делаем обработку множества с условиями, то единственным способом дотянуться из этого условия до текущего элемента будет данная функция.
\item number position() - возвращает позицию элемента в множестве. Корректно работает только в цикле <xsl:for-each/>
\item number last() - возвращает номер последнего элемента в множестве. Корректно работает только в цикле <xsl:for-each/>
\item number count(node-set) - возвращает количество элементов в node-set.
\item string name(node-set?) - возвращает полное имя первого тега в множестве.
\item string namespace-uri(node-set?) - возвращает ссылку на url определяющий пространство имён.
\item string local-name(node-set?) - возвращает имя первого тега в множестве, без пространства имён.
\item node-set id(object) - находит элемент с уникальным идентификатором
\end{itemize}

\textbf{Строковые функции.}

\begin{itemize}
\item string string(object?) - возвращает текстовое содержимое элемента. По сути возвращает объединенное множество текстовых элементов на один уровень ниже.
\item string concat(string, string, string*) - объединяет две или более строк
\item number string-length(string?) - возвращает длину строки.
\item boolean contains(string, string) - возвращает истину, если первая строка содержит вторую, иначе возвращает ложь.
\item string substring(string, number, number?) - возвращает строку вырезанную из строки начиная с указанного номера, и если указан второй номер — количество символов.
\item string substring-before(string, string) - если найдена вторая строка в первой, возвращает строку до первого вхождения второй строки.
\item string substring-after(string, string) - если найдена вторая строка в первой, возвращает строку после первого вхождения второй строки.
\item boolean starts-with(string, string) - возвращает истину если вторая строка входит в начало первой, иначе возвращает ложь.
\item boolean ends-with(string, string) - возвращает истину если вторая строка входит в конец первой, иначе возвращает ложь.
\item string normalize-space(string?) - убирает лишние и повторные пробелы, а также управляющие символы, заменяя их пробелами.
\item string translate(string, string, string) - заменяет символы первой строки, которые встречаются во второй строке, на соответствующие позиции символам из второй строки символы из третьей строки. translate(«bar», «abc», «ABC») вернет BAr.
\end{itemize}

\textbf{Логические функции}

\begin{itemize}
\item or — логическое «или»
\item and — логическое «и»
\item = — логическое «равно»
\item < (\&lt;) — логическое "меньше"
\item > (\&gt;) — логическое "больше"
\item <= (\&lt;=) — логическое "меньше либо равно"
\item >= (\&gt;=) — логическое "больше либо равно"
\end{itemize}

\textbf{Числовые функции}

\begin{itemize}
\item + — сложение
\item - — вычитание
\item * — умножение
\item div — обычное деление (не деление нацело!)
\item mod — остаток от деления
\end{itemize}

%К: приложение
\end{document} 